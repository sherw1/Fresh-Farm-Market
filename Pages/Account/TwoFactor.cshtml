@page
@model AS_Assignment2.Pages.Account.TwoFactorModel
@{
    ViewData["Title"] = "Two-Factor Authentication";
}

<h2> Two-Factor Authentication</h2>
<p>A verification code has been sent to your email. Please enter it below.</p>

@if (!string.IsNullOrEmpty(Model.DemoCode))
{
    <div style="background-color: #fff3cd; border: 2px solid #ffc107; padding: 20px; margin: 20px 0; border-radius: 5px;">
        <h3 style="color: #856404; margin-top: 0;"> Verification Code (For Demo)</h3>
        <p style="color: #856404;"><strong>In production, this code would be sent via email/SMS.</strong></p>
        <p style="color: #856404;">For this demo, your code is:</p>
        <div style="background-color: white; padding: 15px; border: 2px dashed #ffc107; text-align: center; font-size: 32px; font-weight: bold; color: #007bff; letter-spacing: 5px; font-family: monospace; margin: 15px 0;">
            @Model.DemoCode
        </div>
        <p style="color: #856404; font-size: 12px; margin-bottom: 0;">
             This code expires in 10 minutes. Also check your console/terminal for the code.
        </p>
    </div>
}

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div style="background-color: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
         @Model.ErrorMessage
    </div>
}

<form method="post">
    <div style="margin-bottom: 15px;">
        <label asp-for="Input.Code" style="display: block; margin-bottom: 5px; font-weight: bold;">Enter 6-Digit Code</label>
        <input asp-for="Input.Code" autofocus 
               style="width: 100%; max-width: 300px; padding: 12px; font-size: 24px; text-align: center; letter-spacing: 10px; font-family: monospace;" 
               maxlength="6" 
               placeholder="000000" />
        <span asp-validation-for="Input.Code" class="text-danger"></span>
    </div>
    <button type="submit" style="padding: 12px 30px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
         Verify Code
    </button>
</form>

<p style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ccc;">
    <a href="/Account/Login"> Back to Login</a>
</p>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Auto-focus and format input
        var codeInput = document.querySelector('input[type="text"]');
        if (codeInput) {
            codeInput.focus();
            codeInput.addEventListener('input', function(e) {
                // Only allow numbers
                this.value = this.value.replace(/[^0-9]/g, '');
            });
        }
    </script>
}
