@page
@model AS_Assignment2.Pages.Account.ResetPasswordModel
@{
    ViewData["Title"] = "Reset Password";
}

<h2>Reset Password</h2>

@if (!string.IsNullOrEmpty(Model.Message))
{
    <div style="color: @(Model.IsSuccess ? "green" : "red");">@Model.Message</div>
}

@if (Model.IsSuccess)
{
    <p><a href="/Account/Login">Go to Login</a></p>
}
else
{
    <form method="post">
        <div asp-validation-summary="All"></div>
        <input type="hidden" asp-for="Input.Token" />
        <div>
            <label asp-for="Input.NewPassword"></label>
            <input asp-for="Input.NewPassword" type="password" id="password" />
            <span asp-validation-for="Input.NewPassword"></span>
            <div id="passwordStrength" style="margin-top: 5px;"></div>
        </div>
        <div>
            <label asp-for="Input.ConfirmPassword"></label>
            <input asp-for="Input.ConfirmPassword" type="password" />
            <span asp-validation-for="Input.ConfirmPassword"></span>
        </div>
        <button type="submit">Reset Password</button>
    </form>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.getElementById('password').addEventListener('input', function() {
            var password = this.value;
            var strengthDiv = document.getElementById('passwordStrength');
            var strength = 0;
            var feedback = [];
            
            if (password.length >= 12) strength++;
            else feedback.push('At least 12 characters');
            
            if (/[a-z]/.test(password)) strength++;
            else feedback.push('lowercase letter');
            
            if (/[A-Z]/.test(password)) strength++;
            else feedback.push('uppercase letter');
            
            if (/\d/.test(password)) strength++;
            else feedback.push('number');
            
            if (/[!@@#$%^&*()_+=\-{}\[\]:;"'<>,.?/]/.test(password)) strength++;
            else feedback.push('special character');
            
            if (strength < 3) {
                strengthDiv.innerHTML = '<span style="color: red;">Weak - Missing: ' + feedback.join(', ') + '</span>';
            } else if (strength < 5) {
                strengthDiv.innerHTML = '<span style="color: orange;">Medium - Missing: ' + feedback.join(', ') + '</span>';
            } else {
                strengthDiv.innerHTML = '<span style="color: green;">Strong password!</span>';
            }
        });
    </script>
}
